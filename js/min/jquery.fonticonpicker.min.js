!function(i){"use strict";function t(t,s){this.element=i(t),this.settings=i.extend({},e,s),this.settings.emptyIcon&&this.settings.iconsPerPage--,this.iconPicker=i("<div/>",{"class":"icons-selector",style:"position: relative",html:'<div class="selector"><span class="selected-icon"><i class="fa fa-thumbs-up"></i></span><span class="selector-button"><i class="fa fa-caret-down"></i></span></div><div class="selector-popup" style="display: none;">'+(this.settings.hasSearch?'<div class="selector-search"><input type="text" name="" value="" placeholder="Search icon" class="icons-search-input"/><i class="fa fa-search"></i></div>':"")+'<div class="fip-icons-container"></div><div class="selector-footer" style="display:none;"><span class="selector-pages">1/2</span><span class="selector-arrows"><span class="selector-arrow-left" style="display:none;"><i class="fa fa-caret-left"></i></span><span class="selector-arrow-right"><i class="fa fa-caret-right"></i></span></span></div></div>'}),this.iconContainer=this.iconPicker.find(".fip-icons-container"),this.searchIcon=this.iconPicker.find(".selector-search i"),this.iconsSearched=[],this.isSearch=!1,this.totalPage=1,this.currentPage=1,this.currentIcon=!1,this.iconsCount=0,this.open=!1,this.init()}var e={source:!1,emptyIcon:!0,iconsPerPage:20,hasSearch:!0};t.prototype={init:function(){this.element.hide(),this.element.before(this.iconPicker),!this.settings.source&&this.element.is("select")&&(this.settings.source=[],this.element.find("option").each(i.proxy(function(t,e){i(e).val()&&this.settings.source.push(i(e).val())},this))),this.loadIcons(),this.iconPicker.find(".selector-button").click(i.proxy(function(){this.toggleIconSelector()},this)),this.iconPicker.find(".selector-arrow-right").click(i.proxy(function(t){this.currentPage<this.totalPage&&(this.iconPicker.find(".selector-arrow-left").show(),this.currentPage=this.currentPage+1,this.renderIconContainer()),this.currentPage===this.totalPage&&i(t.currentTarget).hide()},this)),this.iconPicker.find(".selector-arrow-left").click(i.proxy(function(t){this.currentPage>1&&(this.iconPicker.find(".selector-arrow-right").show(),this.currentPage=this.currentPage-1,this.renderIconContainer()),1===this.currentPage&&i(t.currentTarget).hide()},this)),this.iconPicker.find(".icons-search-input").keyup(i.proxy(function(t){var e=i(t.currentTarget).val();return""===e?(this.resetSearch(),void 0):(this.searchIcon.removeClass("fip-icon-search"),this.searchIcon.addClass("fip-icon-cancel"),this.isSearch=!0,this.currentPage=1,this.iconsSearched=i.grep(this.settings.source,function(i){return i.search(e.toLowerCase())>=0?i:void 0}),this.renderIconContainer(),void 0)},this)),this.iconPicker.find(".selector-search").on("click",".fip-icon-cancel",i.proxy(function(){this.iconPicker.find(".icons-search-input").focus(),this.resetSearch()},this)),this.iconContainer.on("click",".fip-box",i.proxy(function(t){this.setSelectedIcon(i(t.currentTarget).find("i").attr("class")),this.toggleIconSelector()},this)),this.iconPicker.click(function(i){return i.stopPropagation(),!1}),i("html").click(i.proxy(function(){this.open&&this.toggleIconSelector()},this))},loadIcons:function(){this.iconContainer.html('<i class="fip-icon-spin3 animate-spin loading"></i>'),this.settings.source instanceof Array&&this.renderIconContainer()},renderIconContainer:function(){var t,e=[];if(e=this.isSearch?this.iconsSearched:this.settings.source,this.iconsCount=e.length,this.totalPage=Math.ceil(this.iconsCount/this.settings.iconsPerPage),this.totalPage>1?this.iconPicker.find(".selector-footer").show():this.iconPicker.find(".selector-footer").hide(),this.iconPicker.find(".selector-pages").text(this.currentPage+"/"+this.totalPage),t=(this.currentPage-1)*this.settings.iconsPerPage,this.settings.emptyIcon)this.iconContainer.html('<span class="fip-box"><i class="fa fa-user"></i></span>');else{if(e.length<1)return this.iconContainer.html('<span class="icons-picker-error"><i class="fa fa-user"></i></span>'),void 0;this.iconContainer.html("")}e=e.slice(t,t+this.settings.iconsPerPage);for(var s,n=0;s=e[n++];)i("<span/>",{html:'<i class="'+s+'"></i>',"class":"fip-box"}).appendTo(this.iconContainer);this.settings.emptyIcon||this.element.val()&&-1!==i.inArray(this.element.val(),this.settings.source)?-1===i.inArray(this.element.val(),this.settings.source)?this.setSelectedIcon():this.setSelectedIcon(this.element.val()):this.setSelectedIcon(e[0])},setHighlightedIcon:function(){this.iconContainer.find(".current-icon").removeClass("current-icon"),this.currentIcon&&this.iconContainer.find("."+this.currentIcon).parent("span").addClass("current-icon")},setSelectedIcon:function(i){"fip-icon-block"===i&&(i=""),this.iconPicker.find(".selected-icon").html('<i class="'+(i||"fa fa-maxcdn")+'"></i>'),this.element.val(i).triggerHandler("change"),this.currentIcon=i,this.setHighlightedIcon()},toggleIconSelector:function(){this.open=this.open?0:1,this.iconPicker.find(".selector-popup").slideToggle(300),this.iconPicker.find(".selector-button i").toggleClass("fa fa-caret-down"),this.iconPicker.find(".selector-button i").toggleClass("fa fa-caret-down"),this.open&&this.iconPicker.find(".icons-search-input").focus().select()},resetSearch:function(){this.iconPicker.find(".icons-search-input").val(""),this.searchIcon.removeClass("fip-icon-cancel"),this.searchIcon.addClass("fip-icon-search"),this.iconPicker.find(".selector-arrow-left").hide(),this.currentPage=1,this.isSearch=!1,this.renderIconContainer(),this.totalPage>1&&this.iconPicker.find(".selector-arrow-right").show()}},i.fn.fontIconPicker=function(e){return this.each(function(){i.data(this,"fontIconPicker")||i.data(this,"fontIconPicker",new t(this,e))}),this.setIcons=i.proxy(function(t){this.each(function(){i.data(this,"fontIconPicker").settings.source=t,i.data(this,"fontIconPicker").resetSearch(),i.data(this,"fontIconPicker").loadIcons()})},this),this}}(jQuery);